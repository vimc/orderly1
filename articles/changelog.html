<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>orderly changelog • orderly1</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="orderly changelog">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">orderly1</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bundles.html">orderly bundles</a></li>
    <li><a class="dropdown-item" href="../articles/changelog.html">orderly changelog</a></li>
    <li><a class="dropdown-item" href="../articles/orderly.html">orderly</a></li>
    <li><a class="dropdown-item" href="../articles/patterns.html">orderly patterns</a></li>
    <li><a class="dropdown-item" href="../articles/remote.html">orderly remotes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vimc/orderly/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>orderly changelog</h1>
                        <h4 data-toc-skip class="author">Rich
FitzJohn</h4>
            
            <h4 data-toc-skip class="date">2025-07-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vimc/orderly/blob/main/vignettes/changelog.Rmd" class="external-link"><code>vignettes/changelog.Rmd</code></a></small>
      <div class="d-none name"><code>changelog.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-orderly-changelog">The orderly changelog<a class="anchor" aria-label="anchor" href="#the-orderly-changelog"></a>
</h2>
<p>From version 0.6.0, <code>orderly</code> supports the concept of a
“changelog”. This turns out to be somewhat more complicated than
expected, so the details are explained here.</p>
<div class="section level3">
<h3 id="users-perspective">User’s perspective<a class="anchor" aria-label="anchor" href="#users-perspective"></a>
</h3>
<p>From the user perspective, the changelog functionality should be
fairly simple. Alongside any <code>orderly.yml</code> file, one can have
a <code>changelog.txt</code> file, which will contain description of
changes. This file will look like:</p>
<pre class="plain"><code>[public]
Started working with new version of the data.  This includes
everything sent up to 2018-10-10

[internal]
Fixed incorrect plotting</code></pre>
<p>The short strings within <code>[</code> and <code>]</code> are a
<em>label</em> - everything between a label and the next label or the
end of file is a <em>value</em> (these can span multiple lines, contain
blank lines, etc).</p>
<p>Over time, the changelog is <strong>prepended</strong>, i.e., new
information is added to the <em>top</em> of the changelog. Existing
entries must be left unaltered.</p>
<p>Messages can be provided to <code>orderly_run</code> (or
<code>orderly run</code> on the command line) and these are required to
be in the format <code>[label] value</code>.</p>
<p>Once a report is run (via <code><a href="../reference/orderly_run.html">orderly1::orderly_run()</a></code>, or
via <code>orderly run</code> on the command line), the given changelog,
along with any message, is compared with the last committed version of
this report, and entries that are introduced on this round are
identified. We add the report id to the entries, and a randomly
generated unique id to each new entry. This is saved in
<code>orderly_run.rds</code> along with other report metadata.</p>
</div>
<div class="section level3">
<h3 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h3>
<p><em>Dear intrepid reader, you can stop reading now unless you are
interested in the details of how we have implemented the changelog -
this turned out to be a bit fiddly and this section documents some of
the issues.</em></p>
<p>There are a few complications here</p>
<ul>
<li>we need to accept changelog entries that are not present in a file
(e.g., from the <code>message</code> argument)</li>
<li>we don’t know the id until after running a report so we can’t easily
structure a changelog file in the conventional sense. Instead we have to
detect “old” and “new” entries</li>
<li>detecting “old” entries is complicated by the fact that there might
be multiple places that reports are run (development machine, staging
environment, production environment) but ultimately one source of
truth</li>
</ul>
<p>This section documents the logic involved in making this work.</p>
<p>When preparing to run an orderly report:</p>
<ol style="list-style-type: decimal">
<li>we read in the plaintext changelog if it exists</li>
<li>parse all messages provided and add as if they were a changelog
entry <code>from_file</code> of <code>FALSE</code>
</li>
<li>we look for the “latest” archived version of this report and read
the changelog from that report’s <code>orderly_run.rds</code> file.
Alternatively we can use a remote copy of orderly via the interface here
(not implemented yet).</li>
<li>filter the previous changelog to remove any
<code>from_file = FALSE</code> entries and confirm that our new
changelog can be prepended to the previous</li>
<li>add the <code>id</code> to the “new” entries and prepend this - save
the resulting data into the new report’s
<code>orderly_run.yml</code>
</li>
</ol>
<p>For checking against the API, we will use
<code>GET reports/:name/versions/version/latest/changelog/</code> with
the current report name as <code>:name</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, James Thompson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
